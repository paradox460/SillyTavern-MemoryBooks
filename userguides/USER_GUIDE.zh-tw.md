# 📕 ST 記憶書 - 你的 AI 聊天記憶助手

**將你無盡的聊天對話轉化為有組織、可搜尋的記憶！**

需要機器人記住事情，但聊天內容太長無法放入上下文中？想要自動追蹤重要的情節點而無需手動做筆記？ST 記憶書正是為此而生——它會觀察你的聊天並創建智能摘要，讓你再也不會迷失故事的軌跡。

---

## 🚀 快速入門（5 分鐘內建立你的第一個記憶！）

**剛接觸 ST 記憶書？** 讓我們用幾個點擊來設定你的第一個自動記憶：

### 第 1 步：找到擴充功能

- 在你的聊天輸入框旁邊尋找魔法棒圖示 (🪄)
- 點擊它，然後點擊 **"記憶書"**
- 你會看到 ST 記憶書的控制面板

### 第 2 步：開啟自動魔法

- 在控制面板中，找到 **"自動摘要"**
- 將其開啟
- 設定每 **20-30 則訊息** 建立一次記憶（這是一個很好的起點）
- 就這樣！🎉

### 第 3 步：正常聊天

- 像往常一樣繼續聊天
- 在 20-30 則新訊息後，ST 記憶書將自動：
  - 挑選最佳的場景邊界
  - 要求你的 AI 撰寫摘要
  - 將其儲存到你的記憶收藏中
  - 完成後向你顯示通知

**恭喜！** 你現在擁有了自動化的記憶管理。再也不用忘記幾個章節前發生的事情了！

---

## 💡 ST 記憶書實際上是做什麼的

把 ST 記憶書想像成你的**個人 AI 圖書館員**，專門管理聊天對話：

### 🤖 **自動摘要**

_"我不想考慮那麼多，只要讓它運作就好"_

- 在背景觀察你的聊天
- 每隔 X 則訊息自動建立記憶
- 非常適合長篇角色扮演、創意寫作或持續進行的故事

### ✋ **手動建立記憶**

_"我想控制要儲存的內容"_

- 使用簡單的箭頭按鈕 (► ◄) 標記重要的場景
- 為特殊時刻按需建立記憶
- 非常適合捕捉關鍵情節點或角色發展

### 📊 **側邊提示與智慧追蹤器**

_"我想追蹤關係、情節線索或統計數據"_

- 可重複使用的提示片段，用於增強記憶生成
- 範本庫提供現成的追蹤器
- 自訂 AI 提示，可以追蹤任何你想要的內容
- 自動更新計分板、關係狀態、情節摘要
- 範例："誰喜歡誰？"、"目前任務狀態"、"角色情緒追蹤器"

### 📚 **記憶收藏**

_你所有記憶的存放處_

- 自動整理並可搜尋
- 與 SillyTavern 的內建知識庫系統協同運作
- 你的 AI 可以在新的對話中引用過去的記憶

---

## 🎯 選擇你的風格

<details>
<summary><strong>🔄 "設定後不管" (推薦給初學者)</strong></summary>

**如果你想要：** 無需干預的自動化，一切自動完成

**運作方式：**

1. 在設定中開啟 "自動摘要"
2. 選擇建立記憶的頻率（每 20-50 則訊息效果很好）
3. 正常聊天——記憶會自動產生！

**你會得到：**

- 無需手動操作
- 持續的記憶建立
- 不會錯過重要的故事節點
- 在單人聊天和群組聊天中都有效

**專業提示：** 從 30 則訊息開始，然後根據你的聊天風格進行調整。快節奏的聊天可能需要 50+，而慢節奏的詳細聊天可能更適合 20。

</details>

<details>
<summary><strong>✋ "手動控制" (用於選擇性記憶製作)</strong></summary>

**如果你想要：** 精確決定什麼內容成為記憶

**運作方式：**

1. 在你的聊天訊息上尋找小的箭頭按鈕 (► ◄)
2. 在重要場景的第一則訊息上點擊 ►
3. 在該場景的最後一則訊息上點擊 ◄
4. 開啟記憶書 (🪄) 並點擊 "建立記憶"

**你會得到：**

- 完全控制記憶內容
- 完美捕捉特定時刻
- 非常適合需要仔細界定的複雜場景

**專業提示：** 箭頭按鈕在載入聊天幾秒鐘後出現。如果你沒有看到它們，請稍等片刻或重新整理頁面。

</details>

<details>
<summary><strong>⚡ "進階使用者" (斜線指令)</strong></summary>

**如果你想要：** 鍵盤快捷鍵和進階功能

**基本指令：**

- `/scenememory 10-25` - 從訊息 10 到 25 建立記憶
- `/creatememory` - 從目前標記的場景建立記憶
- `/nextmemory` - 摘要自上次記憶以來的所有內容
- `/sideprompt "關係追蹤器"` - 執行自訂追蹤器

**你會得到：**

- 閃電般快速的記憶建立
- 批次操作
- 與自訂工作流程整合

</details>

---

## 🎨 側邊提示與範本 (進階功能)

**側邊提示** 是可重複使用的提示片段，可以在不變更你的主要 AI 設定的情況下增強你的記憶生成。把它們想像成 "附加元件"，為你的記憶提供額外的焦點或追蹤能力。

### 🚀 **透過範本快速入門**

1. 開啟記憶書設定
2. 點擊 **"側邊提示"** 按鈕
3. 瀏覽 **範本庫** - 選擇適合你故事的範本：
   - **角色發展追蹤器** - 追蹤個性的變化和成長
   - **關係動態** - 監控角色之間的關係
   - **情節線索追蹤器** - 追蹤正在進行的故事線
   - **情緒與氛圍** - 捕捉場景的情感基調
   - **世界觀筆記** - 記錄設定的細節和傳說
4. 啟用你想要的範本，如果需要可以進行自訂
5. 你的記憶現在將自動包含這些額外的追蹤資訊！

### ⚙️ **側邊提示的運作方式**

- **非侵入性**：它們不會變更你的主要 AI 設定或角色提示
- **按聊天控制**：為不同的聊天啟用不同的提示
- **基於範本**：使用預先建置的範本或建立自訂範本
- **自動整合**：一旦啟用，它們會增強建立的每一個記憶

### 🛠️ **管理側邊提示**

- **側邊提示管理器**：建立、編輯、複製和整理你的提示
- **匯入/匯出**：與他人分享提示範本或備份你的收藏
- **快速切換**：在側邊提示彈出視窗中即時啟用/停用提示
- **即時預覽**：查看目前聊天啟用了哪些提示

### 💡 **範本範例**

- 側邊提示範本庫 (匯入此 JSON): [SidePromptTemplateLibrary.json](/resources/SidePromptTemplateLibrary.json)
- **"專注於對話和角色互動"**
- **"追蹤目前任務狀態和目標"**
- **"記錄提到的任何世界觀細節"**
- **"監控 [角色 A] 和 [角色 B] 之間的關係"**

### 🔧 **建立自訂側邊提示**

1. 開啟側邊提示管理器
2. 點擊 "建立新的"
3. 編寫你的提示 (範例："永遠記錄每個場景中的天氣狀況")
4. 儲存並啟用它
5. 現在你所有的記憶都將包含天氣追蹤！

**專業提示**：側邊提示在具體和專注時效果最佳。與其 "追蹤一切"，不如試試 "追蹤主角之間的浪漫張力"。

---

### 🧠 使用 Regex 擴充功能進行進階文字控制

**想要對傳送給 AI 和從 AI 接收的文字擁有最終控制權嗎？** ST 記憶書現在與官方的 **Regex** 擴充功能無縫整合，讓您可以使用自訂規則自動轉換文字。

這是一個進階功能，非常適合希望實現以下目標的使用者：

- 自動清理 AI 回應中的重複片語或殘留內容。
- 在 AI 看到聊天記錄之前重新格式化部分內容。
- 即時標準化術語或角色行為。

#### **運作方式：兩個簡單的掛鉤**

該整合透過在兩個關鍵點套用您啟用的規則運算式指令碼來運作。您可以透過在 Regex 擴充功能的編輯器中設定它們的 **位置** 來控制哪些指令碼執行：

1.  **修改提示（傳出文字）**
    - **要使用的位置**：`User Input`
    - **功能**：在為記憶或側邊提示生成傳送給 AI 之前，攔截完全組裝好的提示（包括聊天記錄、系統指令等）。
    - **使用範例**：您可以建立一個指令碼，自動將角色暱稱的所有實例替換為其全名，以確保 AI 具有正確的上下文。

2.  **修改回應（傳入文字）**
    - **要使用的位置**：`AI Output`
    - **功能**：在 AI 的原始文字回應被解析或儲存為記憶*之前*攔截它。
    - **使用範例**：如果您的 AI 模型經常在其摘要中包含諸如*「作為一個大型語言模型...」*之類的重複片語，您可以建立一個規則運算式指令碼，從它產生的每個記憶中自動刪除此片語。

#### **快速入門範例：清理 AI 回應**

假設您的 AI 模型在其記憶生成中始終新增 `(OOC: 希望這個摘要有幫助！)`。以下是如何自動刪除它：

1.  **前往 Regex 擴充功能**：開啟主 SillyTavern 擴充功能選單，然後前往 **Regex**。
2.  **建立新指令碼**：點擊「開啟 Regex 編輯器」以建立新的規則運算式指令碼。
3.  **設定指令碼**：
    - **指令碼名稱**：`清理 OOC 註解`
    - **尋找 Regex**：`/\\(OOC:.*?\\)/g`（這會尋找文字「(OOC: ...)」及其中的所有內容）。
    - **取代字串**：將此留空以刪除相符的文字。
    - **影響（位置）**：取消選取除 **AI Output** 之外的所有方塊。這是最重要的一步！
    - **啟用指令碼**：確保指令碼未被停用。
4.  **儲存並完成！**

現在，每當 ST 記憶書從 AI 獲得回應時，此指令碼將自動執行，在將記憶儲存到您的知識庫之前清除不需要的文字。

---

## ⚙️ 真正重要的設定

別擔心——你不需要設定所有東西！以下是產生最大影響的設定：

### 🎛️ **自動摘要頻率**

- **20-30 則訊息**：非常適合詳細、慢節奏的聊天
- **40-60 則訊息**：完美適用於快節奏、充滿動作的對話
- **80+ 則訊息**：適用於非常快的群組聊天或休閒對話

### 📝 **記憶預覽**

- 開啟此項以在記憶儲存前進行審查
- 如果 AI 遺漏了重要內容，你可以編輯、批准或重新生成
- 建議用於重要的故事情節

### 🏷️ **記憶標題**

- 自訂你的記憶命名方式
- 使用 `{{title}}` 表示 AI 產生的標題，`{{scene}}` 表示訊息編號
- 範例：`"章節 {{title}} ({{scene}})"` 變為 `"章節 大逃亡 (場景 45-67)"`

### 📚 **記憶收藏** (知識庫)

- **自動模式**：使用你聊天的預設記憶收藏 (最簡單)
- **手動模式**：為每個聊天選擇一個特定的記憶收藏 (用於整理)
- **自動建立**：自動建立新的記憶收藏 (適合新角色)

---

## 🔧 故障排除 (當出現問題時)

### "我沒有看到記憶書選項！"

- 檢查擴充功能是否已安裝並啟用
- 在你的聊天輸入框旁邊尋找魔術棒 (🪄) 圖示
- 嘗試重新整理頁面

### "箭頭按鈕 (► ◄) 沒有顯示！"

- 載入聊天後等待 3-5 秒——它們需要時間出現
- 如果仍然沒有，重新整理頁面
- 確保 ST 記憶書在擴充功能中已啟用

### "自動摘要不運作！"

- 再次檢查記憶書設定中的 "自動摘要" 是否已啟用
- 是否已達到訊息間隔？自動摘要會等待足夠的新訊息
- 如果你推遲了自動摘要，它可能會等到某個訊息計數
- 自動摘要只處理自*上次*記憶以來的新訊息。如果你刪除了舊記憶，它不會追溯。

### "我收到關於缺少知識庫的錯誤！"

- 前往記憶書設定
- 要麼將一個知識庫綁定到你的聊天 (自動模式)，要麼啟用 "如果不存在則自動建立知識庫"

### "有時它會無緣無故地失敗！"

- 確保你的最大回應長度（在 SillyTavern 預設中）設定得足夠大。Aiko 建議至少 2000 個 tokens（Aiko 自己使用 4000）。
- 現在的錯誤訊息更詳細了，但如果你仍然遇到問題，請在 Github 或 Discord 上聯絡 Aiko。

### "我的自訂提示不正常運作！"

- 檢查記憶書設定中的 "摘要提示管理器"
- 確保你的提示指示 AI 以 **JSON 格式** 回應 (例如：`{ "title": "...", "content": "..." }`)

---

## 🚫 ST 記憶書不做的什麼

- **不是通用的知識庫編輯器：** 本指南專注於由 STMB 建立的條目。對於通用的知識庫編輯，請使用 SillyTavern 內建的知識庫編輯器。

---

## 💡 取得協助和更多資訊

- **更詳細的資訊：** [readme.md](readme.md)
- **最新更新：** [changelog.md](changelog.md)
- **轉換舊的知識庫：** [lorebookconverter.html](resources/lorebookconverter.html)
- **社群支援：** 加入 SillyTavern 的 Discord 社群！(尋找 📕ST 記憶書 頻道或直接私訊 @tokyoapple 尋求協助。)
- **錯誤/功能：** 發現了一個錯誤或有一個好主意？在此儲存庫中提交一個 GitHub issue。
